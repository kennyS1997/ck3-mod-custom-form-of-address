VNTL_sgui_init_title_character_key_flag = {
	scope = title

	saved_scopes = {
		character_key_flag
	}

	is_valid = {
		holder = {
			is_ai = no
			primary_title = root # TODO: Also account for HoF title
		}
	}

	effect = {
		# scope:character_key_flag = {
		# 	set_variable = {
		# 		name = VNTL_
		# 	}
		# }

		hidden_effect = {
			scope:character_key_flag = {
				# FIXME: Error: set_variable effect [ This scope doesn't support variables. Scope: Flag TEST_KEY [9386] ]
				#        Maybe I should try in reverse? I.e. save flag on title?
				# set_variable = {
				# 	name = VNTL_title_for_address
				# 	value = root
				# }
			}

			set_variable = {
				name = VNTL_character_key_flag
				value = scope:character_key_flag
			}

			# add_to_global_list = {

			# }

			# This works.
			# if = {
			# 	limit = {
			# 		scope:character_key_flag = flag:TEST_KEY
			# 	}

			# 	holder = {
			# 		add_piety = 500
			# 	}
			# }
		}
	}
}

VNTL_test_sgui_getter = {
	scope = character

	saved_scopes = {
		character_key_flag
	}

	effect = {
		hidden_effect = {
			# FIXME: This doesn't work since var:VNTL_title_for_address can't be stored on a flag in the first place.
			# TODO:  Maybe try iterating over every_player (thanks Tobbzn) and
			# scope:character_key_flag = {
			# 	if = {
			# 		limit = { exists = var:VNTL_title_for_address }
			# 		var:VNTL_title_for_address = {
			# 			save_scope_as = target_title
			# 		}
			# 	}
			# 	else = {
			# 		title:k_ireland = {
			# 			save_scope_as = target_title
			# 		}
			# 	}
			# }

			title:k_papal_state = {
				save_scope_as = target_title

				holder = {
					save_scope_as = target_character
				}
			}

			every_player = {
				limit = {
					primary_title = {
						var:VNTL_character_key_flag = scope:character_key_flag
					}
				}

				save_scope_as = target_character
				primary_title = {
					save_scope_as = target_title
				}
			}
		}

		custom_description_no_bullet = {
			text = VNTL_effect_test
			subject = scope:target_character
			object = scope:target_title
		}
	}
}
